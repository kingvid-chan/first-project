<html>
<head>
  <title>构建BFC（Block Formatting Context）的方法、清除浮动、Margin Collapse</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/276742; Windows/6.3.9600 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="508"/>
<h1>构建BFC（Block Formatting Context）的方法、清除浮动、Margin Collapse</h1>

<div>
<span><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);">一、</span></span>构建BFC（Block Formatting Context）的方法</div><div>（定义）BFC：浮动元素和绝对定位元素，非块级盒子的块级容器（例如 inline-blocks, table-cells, 和 table-captions），以及overflow值不为“visiable”的块级盒子，都会为他们的内容创建新的BFC（块级格式上下文）。</div><div><br/></div><div>方法：</div><div><span style="color: rgb(20, 113, 145);">①float的值不为none。</span></div><div><span style="color: rgb(20, 113, 145);"> </span></div><div><span style="color: rgb(20, 113, 145);">②overflow的值不为visible。</span></div><div><span style="color: rgb(20, 113, 145);"> </span></div><div><span style="color: rgb(20, 113, 145);">③display的值为<span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;">table-cell, table-caption, inline-block</span>中的任何一个。</span></div><div><span style="color: rgb(20, 113, 145);"> </span></div><div><span style="color: rgb(20, 113, 145);">④position的值不为relative和static。</span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);"><br/></span></span></div><div><span style="font-size: 15px;">二、清除浮动</span></div><div><span style="font-size: 15px;">①display:table  清除浮动的原理</span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);">为了保证兼容可以用display: table来使.clearfix形成一个Block Formatting Context。因为display: table会产生一些匿名盒子，这些匿名盒子的其中一个（display值为table-cell）会形成Block Formatting Context。这样我们新的.clearfix就会闭合内部元素的浮动。</span></span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);"><br/></span></span></div><div><span style="background-color: rgb(255, 250, 165);-evernote-highlight:true;"><span style="color: rgb(20, 113, 145);">原因：很明显，float和position不合适我们的需求。那只能从overflow或者display中选取一个。因为是应用了.clearfix和.menu的菜单极有可能是多级的，所以overflow: hidden或overflow: auto也不满足需求（会把下拉的菜单隐藏掉或者出滚动条），那么只能从display下手。 我们可以将.clearfix的display值设为table-cell, table-caption, inline-block中的任何一个但是display: inline-block会产生多余空白，所以也排除掉。剩下的只有table-cell, table-caption</span></span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);"><br/></span></span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);">②.clearfix{</span></span></div><div><font color="#147191"><span style="font-size: 15px;">     *zoom:1;       /*  </span><span style="color: rgb(50, 135, 18);"><span style="font-size: 15px;">IE6/7不支持BFC</span></span></font><span style="color: rgb(50, 135, 18);">，</span><font color="#147191"><span style="color: rgb(50, 135, 18);">通过设置zoom属性</span><span style="font-size: 15px;"><span style="color: rgb(50, 135, 18);">触发IE hasLayout来兼容IE6/7</span>  */</span></font></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);">}</span></span></div><div><span style="font-size: 15px;"><span style="color: rgb(20, 113, 145);"><br/></span></span></div><div><span style="font-size: 15px;">三、合并外边距</span></div><div><a href="http://www.w3cplus.com/css/understanding-bfc-and-margin-collapse.html"></a><a href="http://www.w3cplus.com/css/understanding-bfc-and-margin-collapse.html">http://www.w3cplus.com/css/understanding-bfc-and-margin-collapse.html</a></div><div><h3 style="box-sizing: inherit; margin-top: 20px; margin-bottom: 15px; font-size: 1.3em; color: rgb(0, 183, 233); font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">产生折叠的必备条件：margin必须是邻接的!</h3><p style="box-sizing: inherit; margin: 0px 0px 25px; font-size: 16px; color: rgb(64, 64, 64); font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);">而根据w3c规范，两个margin是邻接的必须满足以下条件：</p><ul style="box-sizing: inherit; margin: 10px 0px 25px; padding: 0px; list-style: none outside none; color: rgb(64, 64, 64); font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif; font-size: 14px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255);"><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">①必须是处于常规文档流（非float和绝对定位）的<a href="http://www.w3.org/TR/CSS2/visuren.html#block-boxes" style="box-sizing: inherit; color: rgb(41, 180, 240); text-decoration: none; background: transparent;" target="_blank">块级盒子</a>,并且处于同一个<a href="http://www.w3.org/TR/CSS2/visuren.html#block-formatting" style="box-sizing: inherit; color: rgb(41, 180, 240); text-decoration: none; background: transparent;" target="_blank">BFC</a>当中。</li><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">②没有线盒，没有空隙（<a href="http://www.w3.org/TR/CSS2/visuren.html#clearance" style="box-sizing: inherit; color: rgb(41, 180, 240); text-decoration: none; background: transparent;" target="_blank">clearance</a>，下面会讲到），没有padding和border将他们分隔开</li><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">③都属于垂直方向上相邻的外边距，可以是下面任意一种情况：</li><li style="list-style: none; display: inline"><ul><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">①元素的margin-top与其第一个常规文档流的子元素的margin-top</li><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">②元素的margin-bottom与其下一个常规文档流的兄弟元素的margin-top</li><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">③height为auto的元素的margin-bottom与其最后一个常规文档流的子元素的margin-bottom</li><li style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;">④高度为0并且最小高度也为0，不包含常规文档流的子元素，并且自身没有建立新的BFC的元素的margin-top和margin-bottom</li></ul></li></ul></div><div><br/></div><div style="box-sizing: inherit; margin-top: 20px; margin-bottom: 15px; color: rgb(0, 183, 233); font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif; font-style: normal; font-variant: normal; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); font-weight: bold; font-size: 17px;"><div>以上的条件意味着下列的规则：</div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">①创建了新的BFC的元素（例如浮动元素或者'overflow'值为'visible'以外的元素）与它的子元素的外边距不会折叠</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;">②<a href="http://www.w3.org/TR/CSS2/visuren.html#floats" style="box-sizing: inherit; color: rgb(41, 180, 240); text-decoration: none; background: transparent;" target="_blank">浮动</a><span style="color: rgb(64, 64, 64);">元素不与任何元素的外边距产生折叠（包括其父元素和子元素）</span></span></span></div><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">③绝对定位元素不与任何元素的外边距产生折叠</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">④inline-block元素不与任何元素的外边距产生折叠</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">⑤一个常规文档流元素的margin-bottom与它下一个常规文档流的兄弟元素的margin-top会产生折叠，除非它们之间存在间隙（clearance）。</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">⑥一个常规文档流元素的margin-top 与其第一个常规文档流的子元素的margin-top产生折叠，条件为父元素不包含 padding 和 border ，子元素不包含 clearance。</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><div><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">⑦一个 'height' 为 'auto' 并且 'min-height' 为 '0'的常规文档流元素的 margin-bottom 会与其最后一个常规文档流子元素的 margin-bottom 折叠，条件为父元素不包含 padding 和 border ，子元素的 margin-bottom 不与包含 clearance 的 margin-top 折叠。</span></span></span></div></div><div style="box-sizing: inherit; margin: 0px; padding: 0px; list-style: none outside none;"><span style="font-size: 14px;"><span style="font-family: &apos;Microsoft YaHei&apos;, 微软雅黑, &apos;Helvetica Neue&apos;, Helvetica, Arial, sans-serif;"><span style="color: rgb(64, 64, 64);">⑧一个不包含border-top、border-bottom、padding-top、padding-bottom的常规文档流元素，并且其 'height' 为 0 或 'auto'， 'min-height' 为 '0'，其里面也不包含行盒(line box)，其自身的 margin-top 和 margin-bottom 会折叠。</span></span></span></div></span>
</div></body></html> 